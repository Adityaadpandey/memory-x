datasource db {
    // could be postgresql or mysql
    provider = "postgresql"
    url      = "postgresql://myuser:mypassword@localhost:5432/memory_x"
}

generator db {
    provider = "go run github.com/steebchen/prisma-client-go"
}

model User {
    id         String      @id @default(uuid())
    name       String
    email      String      @unique
    password   String?
    workspaces Workspace[]
    story      Story[]
    createdAt  DateTime    @default(now())
    updatedAt  DateTime    @updatedAt
}

model Workspace {
    id          String   @id @default(uuid())
    name        String
    description String?
    users       User[]
    caption     String?
    images      Image[]
    stories     Story[]
    createdAt   DateTime @default(now())
    updatedAt   DateTime @updatedAt
}

model Image {
    id          String     @id @default(uuid())
    url         String
    storyId     String?
    createdAt   DateTime   @default(now())
    updatedAt   DateTime   @updatedAt
    Story       Story?     @relation(fields: [storyId], references: [id])
    Workspace   Workspace? @relation(fields: [workspaceId], references: [id])
    workspaceId String?
    Caption     Caption[]
}

model Caption {
    id        String   @id @default(uuid())
    text      String
    imageId   String
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
    Image     Image    @relation(fields: [imageId], references: [id])
}

model Story {
    id          String    @id @default(uuid())
    title       String
    description String?
    workspaceId String
    userId      String
    caption     String?
    images      Image[]
    createdAt   DateTime  @default(now())
    updatedAt   DateTime  @updatedAt
    User        User      @relation(fields: [userId], references: [id])
    Workspace   Workspace @relation(fields: [workspaceId], references: [id])

    @@index([workspaceId])
    @@index([userId])
}
